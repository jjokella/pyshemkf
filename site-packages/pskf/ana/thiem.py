import numpy as np


def head(r, R, Q, delz, K, h0):
    """
    Compute the head around a pumping well according to the THIEM model.
    Source: Batu1998, Aquifer Hydraulics, 3.2.1.

    Parameters
    ----------
    r : float
        Distance from well [m]

    R : float
        Distance, at which the well has no influence anymore. This is
        an input and defined by the user. [m]

    Q : float
        Pumping rate of the well in [m3s-1]

    delz : float
        Thickness of aquifer in [m]

    K : float
       Hydraulic conductivity in [m1s-1]

    h0 : float
        Undisturbed head without influence of the pumping well in [m].
        By definition h0 = h(R).

    Returns
    ----------
    h : float
        head at difference r from pumping well and time t. [m]
    """

    # Compute new head
    if r > 0:
        h = h0 + Q / (2 * np.pi * delz * K) * np.log(R / r)
    else:
        h = np.nan

    return h
